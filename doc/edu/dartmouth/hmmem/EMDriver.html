<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (version 1.7.0_10) on Mon Nov 25 14:18:40 EST 2013 -->
<title>EMDriver</title>
<meta name="date" content="2013-11-25">
<link rel="stylesheet" type="text/css" href="../../../stylesheet.css" title="Style">
</head>
<body>
<script type="text/javascript"><!--
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title="EMDriver";
    }
//-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar_top">
<!--   -->
</a><a href="#skip-navbar_top" title="Skip navigation links"></a><a name="navbar_top_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../edu/dartmouth/hmmem/package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/EMDriver.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../index-files/index-1.html">Index</a></li>
<li><a href="../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li>Prev Class</li>
<li><a href="../../../edu/dartmouth/hmmem/EMModelParameter.html" title="class in edu.dartmouth.hmmem"><span class="strong">Next Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../index.html?edu/dartmouth/hmmem/EMDriver.html" target="_top">Frames</a></li>
<li><a href="EMDriver.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field_summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field_detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">edu.dartmouth.hmmem</div>
<h2 title="Class EMDriver" class="title">Class EMDriver</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li>java.lang.Object</li>
<li>
<ul class="inheritance">
<li>edu.dartmouth.hmmem.EMDriver</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<hr>
<br>
<pre>public class <span class="strong">EMDriver</span>
extends java.lang.Object</pre>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- =========== FIELD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="field_summary">
<!--   -->
</a>
<h3>Field Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Field Summary table, listing fields, and an explanation">
<caption><span>Fields</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Field and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static java.lang.String</code></td>
<td class="colLast"><code><strong><a href="../../../edu/dartmouth/hmmem/EMDriver.html#EM_MODEL_PARAMS_FILE_NAME">EM_MODEL_PARAMS_FILE_NAME</a></strong></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private static java.util.logging.Logger</code></td>
<td class="colLast"><code><strong><a href="../../../edu/dartmouth/hmmem/EMDriver.html#LOGGER">LOGGER</a></strong></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private static java.lang.String</code></td>
<td class="colLast"><code><strong><a href="../../../edu/dartmouth/hmmem/EMDriver.html#startState">startState</a></strong></code>&nbsp;</td>
</tr>
</table>
</li>
</ul>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor_summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Constructor Summary table, listing constructors, and an explanation">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colOne" scope="col">Constructor and Description</th>
</tr>
<tr class="altColor">
<td class="colOne"><code><strong><a href="../../../edu/dartmouth/hmmem/EMDriver.html#EMDriver()">EMDriver</a></strong>()</code>&nbsp;</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method_summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span>Methods</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static java.lang.Double</code></td>
<td class="colLast"><code><strong><a href="../../../edu/dartmouth/hmmem/EMDriver.html#calcLogSumOfLogs(java.lang.Double, java.lang.Double)">calcLogSumOfLogs</a></strong>(java.lang.Double&nbsp;logX,
                java.lang.Double&nbsp;logY)</code>
<div class="block">Given two numbers log(x) and log(y), returns log(x+y).</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static void</code></td>
<td class="colLast"><code><strong><a href="../../../edu/dartmouth/hmmem/EMDriver.html#main(java.lang.String[])">main</a></strong>(java.lang.String[]&nbsp;args)</code>
<div class="block">The main method that drives the distributed EM work flow.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static void</code></td>
<td class="colLast"><code><strong><a href="../../../edu/dartmouth/hmmem/EMDriver.html#outputEMModelParams(java.util.Map, java.util.Map, java.io.DataOutput)">outputEMModelParams</a></strong>(java.util.Map&lt;<a href="../../../edu/dartmouth/hmmem/StringPair.html" title="class in edu.dartmouth.hmmem">StringPair</a>,java.lang.Double&gt;&nbsp;transLogProbMap,
                   java.util.Map&lt;<a href="../../../edu/dartmouth/hmmem/StringPair.html" title="class in edu.dartmouth.hmmem">StringPair</a>,java.lang.Double&gt;&nbsp;emisLogProbMap,
                   java.io.DataOutput&nbsp;out)</code>
<div class="block">Outputs the given transition and emission log prob maps in the form of serialized EMModelParameters to the given DataOutput.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private static java.util.Map&lt;<a href="../../../edu/dartmouth/hmmem/StringPair.html" title="class in edu.dartmouth.hmmem">StringPair</a>,java.lang.Double&gt;</code></td>
<td class="colLast"><code><strong><a href="../../../edu/dartmouth/hmmem/EMDriver.html#parsePairFile(java.io.BufferedReader, boolean)">parsePairFile</a></strong>(java.io.BufferedReader&nbsp;fileReader,
             boolean&nbsp;isTransFile)</code>
<div class="block">Parses the given pair file, where each line is of the form
 "<from_state> <to_state>" (for transition files) or "<state> <token>" for emission files.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private static void</code></td>
<td class="colLast"><code><strong><a href="../../../edu/dartmouth/hmmem/EMDriver.html#runEMIteration(java.lang.String, java.lang.String, java.lang.String, java.lang.String, java.lang.String, int)">runEMIteration</a></strong>(java.lang.String&nbsp;jobName,
              java.lang.String&nbsp;bucketURIStr,
              java.lang.String&nbsp;inputDirPathStr,
              java.lang.String&nbsp;outputDirPathStr,
              java.lang.String&nbsp;startState,
              int&nbsp;iteration)</code>
<div class="block">Conduct a single iteration of EM.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private static void</code></td>
<td class="colLast"><code><strong><a href="../../../edu/dartmouth/hmmem/EMDriver.html#runViterbi(java.lang.String, java.lang.String, java.lang.String, java.lang.String, java.lang.String, java.lang.String)">runViterbi</a></strong>(java.lang.String&nbsp;jobName,
          java.lang.String&nbsp;bucketURIStr,
          java.lang.String&nbsp;inputDirPathStr,
          java.lang.String&nbsp;outputDirPathStr,
          java.lang.String&nbsp;startState,
          java.lang.String&nbsp;modelParamsDirPathStr)</code>
<div class="block">Run a Viterbi tagging job.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods_inherited_from_class_java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.Object</h3>
<code>clone, equals, finalize, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ FIELD DETAIL =========== -->
<ul class="blockList">
<li class="blockList"><a name="field_detail">
<!--   -->
</a>
<h3>Field Detail</h3>
<a name="LOGGER">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>LOGGER</h4>
<pre>private static final&nbsp;java.util.logging.Logger LOGGER</pre>
</li>
</ul>
<a name="EM_MODEL_PARAMS_FILE_NAME">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>EM_MODEL_PARAMS_FILE_NAME</h4>
<pre>public static final&nbsp;java.lang.String EM_MODEL_PARAMS_FILE_NAME</pre>
<dl><dt><span class="strong">See Also:</span></dt><dd><a href="../../../constant-values.html#edu.dartmouth.hmmem.EMDriver.EM_MODEL_PARAMS_FILE_NAME">Constant Field Values</a></dd></dl>
</li>
</ul>
<a name="startState">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>startState</h4>
<pre>private static&nbsp;java.lang.String startState</pre>
</li>
</ul>
</li>
</ul>
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor_detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a name="EMDriver()">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>EMDriver</h4>
<pre>public&nbsp;EMDriver()</pre>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method_detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="main(java.lang.String[])">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>main</h4>
<pre>public static&nbsp;void&nbsp;main(java.lang.String[]&nbsp;args)
                 throws java.lang.Exception</pre>
<div class="block">The main method that drives the distributed EM work flow.
 
 Arguments:
 0: Job name, e.g. "distributed-hmm-em"
 1: The bucket URI, e.g. "s3n://distributed-hmm-em/" for the file system
 2: Path to input directory containing emission sequences (one per line), e.g. "s3n://distributed-hmm-em/input"
 3: Path to output directory that does not yet exist, e.g. "s3n://distributed-hmm-em/output-13"
 4: Path to transitions file (each line of format "<from_state> <to_state>", with the first from_state
                being the symbol for the start of the emission sequence, e.g. "s3n://distributed-hmm-em/transitions.txt"
 5: Path to emissions file (each line of format "<state> <token>", e.g. "s3n://distributed-hmm-em/emissions.txt"
 6: Log convergence, i.e. difference between log alpha of EM iterations before final output is produced,
                e.g. "0.00001"
 7: Max number of EM iterations, or -1 for no maximum.
 8: Number of different random seeds for model parameters.
 9: Flag to enable Viterbi tagging following EM, e.g. a nonzero int (e.g. 1 or -1) to enable and 0 to disable
 
 The main method first parses the input transition and emissions to generate
 a random seed for the model parameters. Then, the method spawns MapReduce steps
 that each perform one EM iteration until the difference between the log alphas
 after each iteration is less than the given convergence argument.</div>
<dl><dt><span class="strong">Throws:</span></dt>
<dd><code>java.lang.Exception</code></dd></dl>
</li>
</ul>
<a name="parsePairFile(java.io.BufferedReader, boolean)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>parsePairFile</h4>
<pre>private static&nbsp;java.util.Map&lt;<a href="../../../edu/dartmouth/hmmem/StringPair.html" title="class in edu.dartmouth.hmmem">StringPair</a>,java.lang.Double&gt;&nbsp;parsePairFile(java.io.BufferedReader&nbsp;fileReader,
                                                       boolean&nbsp;isTransFile)
                                                                 throws java.lang.Exception</pre>
<div class="block">Parses the given pair file, where each line is of the form
 "<from_state> <to_state>" (for transition files) or "<state> <token>" for emission files.
 Assigns a random probability to each transition/emission
 and normalizes such that the sum of all transitions/emissions from a given state
 is 1.0. Returns a dictionary mapping the tuple to the log
 of the randomized and normalized probability.
 
 If isTransFile is set, indicating we are parsing a transition file, then the fromState of the
 first transition is used as the start state for all emission sequences.</div>
<dl><dt><span class="strong">Throws:</span></dt>
<dd><code>java.lang.Exception</code></dd></dl>
</li>
</ul>
<a name="calcLogSumOfLogs(java.lang.Double, java.lang.Double)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>calcLogSumOfLogs</h4>
<pre>public static&nbsp;java.lang.Double&nbsp;calcLogSumOfLogs(java.lang.Double&nbsp;logX,
                                java.lang.Double&nbsp;logY)</pre>
<div class="block">Given two numbers log(x) and log(y), returns log(x+y). If both log(x) and log(y) are negative,
 calculates the log of the sum in the following manner to reduce the risk of underflow:
 Finds log(z) = min(log(x), log(y)). Then adds log(z) to both log(x) and log(y) before
 exponentiating, adds the two exponentiations, takes the log of the sum, and then
 subtracts log(z). This calculation works properly because z*x + z*y = z*(x+y),
 so 2^(log(z)+log(x)) + 2^(log(z)+log(y)) = 2^(log(z)+log(x+y)).
 Thus, log(2^(log(z)+log(x)) + 2^(log(z)+log(y))) = log(2^(log(z)+log(x+y))) = log(z)+log(x+y).

 Note: If logx (logy) is passed as null, then x (y) is interpreted as 0. If both parameters
 are passed as null, then null is returned.</div>
</li>
</ul>
<a name="outputEMModelParams(java.util.Map, java.util.Map, java.io.DataOutput)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>outputEMModelParams</h4>
<pre>public static&nbsp;void&nbsp;outputEMModelParams(java.util.Map&lt;<a href="../../../edu/dartmouth/hmmem/StringPair.html" title="class in edu.dartmouth.hmmem">StringPair</a>,java.lang.Double&gt;&nbsp;transLogProbMap,
                       java.util.Map&lt;<a href="../../../edu/dartmouth/hmmem/StringPair.html" title="class in edu.dartmouth.hmmem">StringPair</a>,java.lang.Double&gt;&nbsp;emisLogProbMap,
                       java.io.DataOutput&nbsp;out)
                                throws java.io.IOException</pre>
<div class="block">Outputs the given transition and emission log prob maps in the form of serialized EMModelParameters to the given DataOutput.</div>
<dl><dt><span class="strong">Throws:</span></dt>
<dd><code>java.io.IOException</code></dd></dl>
</li>
</ul>
<a name="runEMIteration(java.lang.String, java.lang.String, java.lang.String, java.lang.String, java.lang.String, int)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>runEMIteration</h4>
<pre>private static&nbsp;void&nbsp;runEMIteration(java.lang.String&nbsp;jobName,
                  java.lang.String&nbsp;bucketURIStr,
                  java.lang.String&nbsp;inputDirPathStr,
                  java.lang.String&nbsp;outputDirPathStr,
                  java.lang.String&nbsp;startState,
                  int&nbsp;iteration)
                            throws java.io.IOException</pre>
<div class="block">Conduct a single iteration of EM. Returns true if the algorithm has converged.</div>
<dl><dt><span class="strong">Throws:</span></dt>
<dd><code>java.io.IOException</code></dd></dl>
</li>
</ul>
<a name="runViterbi(java.lang.String, java.lang.String, java.lang.String, java.lang.String, java.lang.String, java.lang.String)">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>runViterbi</h4>
<pre>private static&nbsp;void&nbsp;runViterbi(java.lang.String&nbsp;jobName,
              java.lang.String&nbsp;bucketURIStr,
              java.lang.String&nbsp;inputDirPathStr,
              java.lang.String&nbsp;outputDirPathStr,
              java.lang.String&nbsp;startState,
              java.lang.String&nbsp;modelParamsDirPathStr)
                        throws java.io.IOException</pre>
<div class="block">Run a Viterbi tagging job.</div>
<dl><dt><span class="strong">Throws:</span></dt>
<dd><code>java.io.IOException</code></dd></dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar_bottom">
<!--   -->
</a><a href="#skip-navbar_bottom" title="Skip navigation links"></a><a name="navbar_bottom_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../edu/dartmouth/hmmem/package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/EMDriver.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../index-files/index-1.html">Index</a></li>
<li><a href="../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li>Prev Class</li>
<li><a href="../../../edu/dartmouth/hmmem/EMModelParameter.html" title="class in edu.dartmouth.hmmem"><span class="strong">Next Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../index.html?edu/dartmouth/hmmem/EMDriver.html" target="_top">Frames</a></li>
<li><a href="EMDriver.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field_summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field_detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</body>
</html>
